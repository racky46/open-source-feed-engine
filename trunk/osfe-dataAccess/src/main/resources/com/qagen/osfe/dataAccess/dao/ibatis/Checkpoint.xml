<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
  "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="CheckPoint">

  <typeAlias alias="CheckPoint" type="com.qagen.osfe.dataAccess.vo.Checkpoint"/>

  <resultMap id="resultMap" class="CheckPoint">
    <result property="checkpointId" column="checkpoint_id"/>
    <result property="phaseId" column="phase_id"/>
    <result property="currentFileIndex" column="current_file_index"/>
    <result property="feedFile" column="feed_file_id" select="FeedFile.findByPrimaryId"/>
  </resultMap>

  <insert id="insert" parameterClass="CheckPoint">
    insert into t_checkpoint (
      phase_id,
      current_file_index,
      feed_file_id
    ) values (
      #phaseId#,
      #currentFileIndex#,
      #feedFile.feedFileId#
    )

    <selectKey resultClass="int" keyProperty="checkpointId">
      select @@identity as checkpoint_id
    </selectKey>
  </insert>

  <update id="update" parameterClass="CheckPoint">
    update t_checkpoint set
      phase_id = #phaseId#,
      current_file_index = #currentFileIndex#,
      feed_file_id = #feedFile.feedFileId#
    where checkpoint_id = #checkpointId#
  </update>

  <delete id="delete" parameterClass="CheckPoint">
    delete from t_checkpoint where checkpoint_id = #checkpointId#
  </delete>

  <select id="findByPrimaryId" parameterClass="int" resultMap="CheckPoint.resultMap">
    select * from t_checkpoint where checkpoint_id = #value#
  </select>

  <select id="findByFeedFileId" parameterClass="int" resultMap="CheckPoint.resultMap">
    select * from t_checkpoint where feed_file_id = #value#
  </select>

</sqlMap>